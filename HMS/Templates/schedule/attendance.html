
{% load tz %}
{% load custom_filter %}

<style>

.bg-light-gray {
    background-color: #188dec;
}
.bg-light-blue {
    background-color: #7ea6cc;
}
.table-bordered thead td, .table-bordered thead th {
    border-bottom-width: 2px;
}
.table thead th {
    vertical-align: bottom;
    border-bottom: 2px solid #dee2e6;
}
.table-bordered td, .table-bordered th {
    border: 1px solid #dee2e6;
}


.bg-sky.box-shadow {
    box-shadow: 0px 5px 0px 0px #00a2a7
}

.bg-orange.box-shadow {
    box-shadow: 0px 5px 0px 0px #af4305
}

.bg-green.box-shadow {
    box-shadow: 0px 5px 0px 0px #4ca520
}

.bg-yellow.box-shadow {
    box-shadow: 0px 5px 0px 0px #dcbf02
}

.bg-pink.box-shadow {
    box-shadow: 0px 5px 0px 0px #e82d8b
}

.bg-purple.box-shadow {
    box-shadow: 0px 5px 0px 0px #8343e8
}

.bg-lightred.box-shadow {
    box-shadow: 0px 5px 0px 0px #d84213
}


.bg-sky {
    background-color: #02c2c7
}

.bg-red {
    background-color: #f1223e
}

.bg-green {
    background-color: #5bbd2a
}

.bg-yellow {
    background-color: #f0d001
}

.bg-pink {
    background-color: #ff48a4
}

.bg-purple {
    background-color: #9d60ff
}

.bg-lightred {
    background-color: #ff5722
}

.padding-15px-lr {
    padding-left: 15px;
    padding-right: 15px;
}
.padding-5px-tb {
    padding-top: 5px;
    padding-bottom: 5px;
}
.margin-10px-bottom {
    margin-bottom: 10px;
}
.border-radius-5 {
    border-radius: 5px;
}

.margin-10px-top {
    margin-top: 10px;
}
.font-size14 {
    font-size: 14px;
}

.text-light-gray {
    color: #d6d5d5;
}
.font-size13 {
    font-size: 13px;
}

.table-bordered td, .table-bordered th {
    border: 1px solid #dee2e6;
}
.table td, .table th {
    padding: .75rem;
    vertical-align: top;
    border-top: 1px solid #dee2e6;
}
.nav-span span {
    color: #252525;
    font-size: 40px;
    line-height: 50px;
    font-weight: 600;
    float:none;
    margin-left: auto;
    margin-right: auto;
}

.navigate a {
  text-decoration: none;
  display: inline-block;
  padding: 8px 16px;
}

.navigate a:hover {
  background-color: #ddd;
  color: black;
}

.previous {
  background-color: #f1f1f1;
  color: black;
}

.next {
  background-color: #f1f1f1;
  color: black;
}


</style>
<div class="container">

    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="{% url 'menu'%}"><i class="fas fa-home"></i></a></li>
          <li class="breadcrumb-item" aria-current="page"><a href="{% url 'employee-menu'%}">Employee</a></li>
          <li class="breadcrumb-item active" aria-current="page">Schedule</li>
        </ol>
    </nav>
</div> 
<div class="container py-5">
        <div class="col-lg-12 nav-span media ">
            <span class="navigate">
                <a href="/schedule/attendance/previous/{{date}}" id="previous" class="previous text-center">&#8249;</a>
            </span>
            <span class="text-center" id="title">
                 {{ week_schedules }}
            </span>
            <span class="navigate">
                <a href="/schedule/attendance/next/{{date}}" id="next" class="text-center next">&#8250;</a>
            </span>
        </div>
        <div class="table-responsive">
            <table class="table table-bordered text-center ">
                <thead>
                    <tr class="bg-light-gray text-white">
                        <th class="text-uppercase">Name
                        </th>
                        <th class="text-uppercase">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                        <th class="text-uppercase">Sun</th>
                        <th class="text-uppercase">Mon</th>
                        <th class="text-uppercase">Tue</th>
                        <th class="text-uppercase">Wed</th>
                        <th class="text-uppercase">Thu</th>
                        <th class="text-uppercase">Fri</th>
                        <th class="text-uppercase">Sat</th>
                    </tr>
                </thead>
                <tbody>

                    <tr class="bg-light-gray text-white">
                        <td class="tdinput" colspan="2">                
                        </td>
                        <td class="tdinput" id="sun">{{date|add_days:0 }}
                        </td>
                        <td class="tdinput" id="mon">{{date|add_days:1 }}
                        </td>
                        <td class="tdinput" id="tue">{{date|add_days:2 }}
                        </td>
                        <td class="tdinput" id="wed">{{date|add_days:3 }}
                        </td>
                        <td class="tdinput" id="thu">{{date|add_days:4 }}
                        </td>
                        <td class="tdinput" id="fri">{{date|add_days:5 }}
                        </td>
                        <td class="tdinput" id="sat">{{date|add_days:6 }}
                        </td>
                    </tr>                    
                    <tr class="">
                        <td class="tdinput" colspan="2">                
                        </td>
                        <td class="tdinput" colspan="7">     SUPERVISORS           
                        </td>
                    </tr>
                    {% for schedule in schedules %}
                    {% if schedule.position == ''%}    
                    <tr class="schedule-supervisors">
                        <td class="bg-light-blue">{{schedule.schedules_id}}</td>
                        <td class="bg-light-blue schedule-name">{{schedule.name}}</td>
                        <td   class="tdinput schedule-sun" >{{schedule.sun}}</td>
                        <td   class="tdinput schedule-mon" >{{schedule.mon}}</td>
                        <td   class="tdinput schedule-tue" >{{schedule.tue}}</td>
                        <td   class="tdinput schedule-wed" >{{schedule.wed}}</td>
                        <td   class="tdinput schedule-thu" >{{schedule.thu}}</td>
                        <td   class="tdinput schedule-fri" >{{schedule.fri}}</td>
                        <td   class="tdinput schedule-sat" >{{schedule.sat}}</td>
                    </tr>
                    {%endif%}
                    {% endfor %} 
                    <tr class="text-white">
                        <td class="tdinput" colspan="2">                
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn btn-outline-secondary" disabled>Closed</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn btn-outline-secondary" disabled>Closed</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="tue" data-role="schedule-supervisors" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="wed" data-role="schedule-supervisors" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="thu" data-role="schedule-supervisors" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="fri" data-role="schedule-supervisors" data-target="#CloseDay">Close</button>
                        </td>
                        <td>
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="sat" data-role="schedule-supervisors" data-target="#CloseDay">Close</button>
                        </td>
                    </tr>                
                    <tr class="">
                        <td class="tdinput" colspan="2">      FULL TIME          
                        </td>
                        <td class="tdinput" colspan="7">     HOUSEKEEPERS           
                        </td>
                    </tr>
                    {% for schedule in schedules %}
                    {% if schedule.position == 'FULL TIME' and schedule.role == 'HOUSEKEEPERS'%}          
                    <tr class="schedule-full-housekeepers">
                        <td class="bg-light-blue">{{schedule.schedules_id}}</td>
                        <td class="bg-light-blue schedule-name">{{schedule.name}}</td>
                        <td   class="tdinput schedule-sun" >{{schedule.sun}}</td>
                        <td   class="tdinput schedule-mon" >{{schedule.mon}}</td>
                        <td   class="tdinput schedule-tue" >{{schedule.tue}}</td>
                        <td   class="tdinput schedule-wed" >{{schedule.wed}}</td>
                        <td   class="tdinput schedule-thu" >{{schedule.thu}}</td>
                        <td   class="tdinput schedule-fri" >{{schedule.fri}}</td>
                        <td   class="tdinput schedule-sat" >{{schedule.sat}}</td>
                    </tr>
                    {%endif%}
                    {% endfor %}     
                    <tr class="text-white">
                        <td class="tdinput" colspan="2">                
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="sun" data-role="schedule-full-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="mon" data-role="schedule-full-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="tue" data-role="schedule-full-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="wed" data-role="schedule-full-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="thu" data-role="schedule-full-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="fri" data-role="schedule-full-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                        <td>
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="sat" data-role="schedule-full-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                    </tr>                   
                    <tr class="">
                        <td class="tdinput" colspan="2">PART TIME          
                        </td>
                        <td class="tdinput" colspan="7">HOUSEKEEPERS           
                        </td>
                    </tr>
                    {% for schedule in schedules %}
                    {% if schedule.position == 'PART TIME' and schedule.role == 'HOUSEKEEPERS'%}     
                    <tr class="schedule-part-housekeepers">
                        <td class="bg-light-blue">{{schedule.schedules_id}}</td>
                        <td class="bg-light-blue schedule-name">{{schedule.name}}</td>
                        <td   class="tdinput schedule-sun" >{{schedule.sun}}</td>
                        <td   class="tdinput schedule-mon" >{{schedule.mon}}</td>
                        <td   class="tdinput schedule-tue" >{{schedule.tue}}</td>
                        <td   class="tdinput schedule-wed" >{{schedule.wed}}</td>
                        <td   class="tdinput schedule-thu" >{{schedule.thu}}</td>
                        <td   class="tdinput schedule-fri" >{{schedule.fri}}</td>
                        <td   class="tdinput schedule-sat" >{{schedule.sat}}</td>
                    </tr>
                    {%endif%}
                    {% endfor %}     
                    <tr class="text-white">
                        <td class="tdinput" colspan="2">                
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="sun" data-role="schedule-part-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="mon" data-role="schedule-part-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="tue" data-role="schedule-part-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="wed" data-role="schedule-part-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="thu" data-role="schedule-part-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="fri" data-role="schedule-part-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                        <td>
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="sat" data-role="schedule-part-housekeepers" data-target="#CloseDay">Close</button>
                        </td>
                    </tr>                       
                    <tr class="">
                        <td class="tdinput" colspan="2">PART TIME          
                        </td>
                        <td class="tdinput" colspan="7">HOUSEMAN           
                        </td>
                    </tr>
                    {% for schedule in schedules %}
                    {% if schedule.position == 'PART TIME' and schedule.role == 'HOUSEMAN'%}     
                    <tr class="schedule-part-houseman">
                        <td class="bg-light-blue">{{schedule.schedules_id}}</td>
                        <td class="bg-light-blue schedule-name">{{schedule.name}}</td>
                        <td   class="tdinput schedule-sun" >{{schedule.sun}}</td>
                        <td   class="tdinput schedule-mon" >{{schedule.mon}}</td>
                        <td   class="tdinput schedule-tue" >{{schedule.tue}}</td>
                        <td   class="tdinput schedule-wed" >{{schedule.wed}}</td>
                        <td   class="tdinput schedule-thu" >{{schedule.thu}}</td>
                        <td   class="tdinput schedule-fri" >{{schedule.fri}}</td>
                        <td   class="tdinput schedule-sat" >{{schedule.sat}}</td>
                    </tr>
                    {%endif%}
                    {% endfor %}   
                    <tr class="text-white">
                        <td class="tdinput" colspan="2">                
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="sun" data-role="schedule-part-houseman" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="mon" data-role="schedule-part-houseman" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="tue" data-role="schedule-part-houseman" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="wed" data-role="schedule-part-houseman" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="thu" data-role="schedule-part-houseman" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="fri" data-role="schedule-part-houseman" data-target="#CloseDay">Close</button>
                        </td>
                        <td>
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="sat" data-role="schedule-part-houseman" data-target="#CloseDay">Close</button>
                        </td>
                    </tr>                     
                    <tr class="">
                        <td class="tdinput" colspan="2">      FULL TIME          
                        </td>
                        <td class="tdinput" colspan="7">     HOUSEMAN           
                        </td>
                    </tr>
                    {% for schedule in schedules %}
                    {% if schedule.position == 'FULL TIME' and schedule.role == 'HOUSEMAN'%}   
                    <tr class="schedule-full-houseman">
                        <td class="bg-light-blue">{{schedule.schedules_id}}</td>
                        <td class="bg-light-blue schedule-name">{{schedule.name}}</td>
                        <td   class="tdinput schedule-sun" >{{schedule.sun}}</td>
                        <td   class="tdinput schedule-mon" >{{schedule.mon}}</td>
                        <td   class="tdinput schedule-tue" >{{schedule.tue}}</td>
                        <td   class="tdinput schedule-wed" >{{schedule.wed}}</td>
                        <td   class="tdinput schedule-thu" >{{schedule.thu}}</td>
                        <td   class="tdinput schedule-fri" >{{schedule.fri}}</td>
                        <td   class="tdinput schedule-sat" >{{schedule.sat}}</td>
                    </tr>
                    {%endif%}
                    {% endfor %}       
                    <tr class="text-white">
                        <td class="tdinput" colspan="2">                
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="sun" data-role="schedule-full-houseman" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="mon" data-role="schedule-full-houseman" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="tue" data-role="schedule-full-houseman" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="wed" data-role="schedule-full-houseman" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="thu" data-role="schedule-full-houseman" data-target="#CloseDay">Close</button>
                        </td>
                        <td class="tdinput">
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="fri" data-role="schedule-full-houseman" data-target="#CloseDay">Close</button>
                        </td>
                        <td>
                            <button type="button" class="btn btn-outline-danger" data-toggle="modal" data-day="sat" data-role="schedule-full-houseman" data-target="#CloseDay">Close</button>
                        </td>
                    </tr>     
                </tbody>
            </table>
        </div>

</div>

<!-- Modal -->
<div class="modal fade" id="CloseDay" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Modal Title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Modal Content Goes Here
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-success" data-dismiss="modal">Success</button>
                <!-- Add more buttons if needed -->
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {     
        $('.navigate').click(function() {   
            var param = this.getElementsByTagName("a")[0].id;

            //$("#title").text(nextDate());
            $.get( "schedule", function( data ) {
                $("#title").html( data );
                alert( "Load was performed." );
            });
/*
            $.ajax({
                url: '/schedule/ajax/',  
                data: {
                    'param': param  
                },
                type: 'GET',
                dataType: 'json',
                success: function(data) {
                    $('#ajax-response').html(data.message);
                }
            });*/
        });
    });
    $(document).ready(function() {
        $('.tdinput').on('blur', function() {
            var value = this.innerHTML.trim()
            console.log(value);
        });
    });
    function nextDate() {
        var today = new Date();
        today.setDate(today.getDate() + (- 1 - today.getDay() + 7) % 7 + 1);
        return today;
    }

$('#CloseDay').on('show.bs.modal', function (event) {
    var self = $(event.relatedTarget) // Button that triggered the modal
    var day =  self.data('day');
    var role = "." + self.data('role');
            console.log($(role).find('.schedule-name'));
            console.log($(role).find('.schedule-'+day));
    var title = $("#" + day).html();
            console.log(title);
    var modal = $(this)
    var nameList = Array.from($(role).find('.schedule-name'));
    var dayList = Array.from($(role).find('.schedule-'+day));
    let numCallbackRuns = 0;
    
    var ttable = $('<tbody class="table">');
    nameList.forEach( el => {
                        let time_check = (dayList[numCallbackRuns].innerHTML.indexOf(":") > 0 ?  dayList[numCallbackRuns].innerHTML + " - " + dayList[numCallbackRuns].innerHTML : dayList[numCallbackRuns].innerHTML);
                        ttable.append(
                            '<tr><td>' + el.innerHTML +
                            '</td><td contenteditable="true" style="cursor:pointer;">' + time_check +
                            '</td></tr>');
                            
                        console.log(dayList[numCallbackRuns].innerHTML );
                        console.log(dayList[numCallbackRuns].innerHTML.indexOf(":") > 0 ?  dayList[numCallbackRuns].innerHTML + " - " + dayList[numCallbackRuns].innerHTML  : "pi" );
                        numCallbackRuns++;
                });
    $('.modal-body').html($('<table class=" table-responsive w-100 d-block d-md-table">').append('<thead><tr><th>Name</th><th>Time</th></tr></thead>').append(ttable));

    modal.find('.modal-title').text(title)
});
    </script>

